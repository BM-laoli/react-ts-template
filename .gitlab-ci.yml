# @format

# æ‰§è¡Œå‰é…ç½®ç¯å¢ƒ ã€packageã€‘
# node_module install ã€installã€‘
# æ£€æŸ¥hsuky ï¼Œä»£ç æ ¼å¼åŒ– ï¼Œæ£€æŸ¥eslint  ã€lintã€‘
# docker ï¼ˆå®¹å™¨åŒ…ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯nodeä¸‹çš„ä¸€ä¸ªngxç±»ä¼¼çš„ğŸ”§å®ƒå°±æ˜¯æˆ‘ä»¬ï¼‰ ã€dockerã€‘
# run docker ( èµ°ä¸€ä¸ª æ‰§è¡Œdocker æ–‡ä»¶ )ã€rundockerã€‘

# éœ€è¦ç»™å®šä¸€äº›å˜é‡æ§åˆ¶ci/cdçš„æ‰§è¡Œ
# è¿™é‡Œæ˜¯ä¸€ä¸ª æ¯”è¾ƒå¥½çš„ ç¤ºä¾‹ï¼ˆhttps://gitlab.com/python-devs/ci-images/-/blob/main/.gitlab-ci.ymlï¼‰
image: node:alpine

stages: # åˆ†æ®µ
    - package
    - install
    - lint
    - build
    - deploy

cache: # ç¼“å­˜
    paths:
        - node_modules
        - build

package-job:
    tags:
        - sss
    stage: package
    script:
        - npm config set registry https://registry.npm.taobao.org/

install-job:
    tags:
        - sss
    stage: install
    script:
        - npm install

lint-job:
    tags:
        - sss
    stage: lint
    script:
        - npm run prettier-format
        - npm run lint

build-job:
    tags:
        - sss
    stage: build
    script:
        - npm run build
        # ç»™å®šä¸€ä¸ª path çš„åˆ°ä¸€ä¸ªbuild ç›®å½•

deploy-job: #  æ‹¿åˆ°buildçš„ç›®å½•å»æ„å»ºä¸€ä¸ªdocker iamge
    tags:
        - sss
    stage: deploy
    script:
        - pwd && ls
